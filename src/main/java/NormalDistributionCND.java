// Calculates the Normal distribution with |e(x)| < 1.0e-8
public class NormalDistributionCND {
    public NormalDistributionCND() {
    }

    public double CND(double x) {
        double sgn;
        double x2, q0, q1, q2;
        if (x < 0.0) {
            x = -x;
            sgn = -1.0;
        }
        else if (x > 0.0) {
            sgn = 1.0;
        }
        else /* x == 0.0 */
            return 0.5;

        if (x > 20.0) {
            if (sgn < 0)
                return 0.0;
            else
                return 1.0;
        }
        x *= 0.70710678118654746; // 1/sqrt(2)
        x2 = x * x;
        if (x < 0.46875) {
            q1 = 3209.37758913846947
                    +x2*(377.485237685302021
                    +x2*(113.864154151050156
                    +x2*(3.16112374387056560
                    +x2*0.185777706184603153)));
            q2 = 2844.23683343917062
                    +x2*(1282.61652607737228
                    +x2*(244.024637934444173
                    +x2*(23.6012909523441209
                    +x2)));
            return 0.5*(1.0+sgn*x*q1/q2);
        }
        else if (x < 4.0) {
            q1 = 1230.33935479799725
                    +x*(2051.07837782607147
                    +x*(1712.04761263407058
                    +x*(881.952221241769090
                    +x*(298.635138197400131
                    +x*(66.1191906371416295
                    +x*(8.88314979438837594
                    +x*(0.564188496988670089
                    +x*2.15311535474403846e-8)))))));
            q2 = 1230.33935480374942
                    +x*(3439.36767414372164
                    +x*(4362.61909014324716
                    +x*(3290.79923573345963
                    +x*(1621.38957456669019
                    +x*(537.181101862009858
                    +x*(117.693950891312499
                    +x*(15.7449261107098347
                    +x)))))));
            return 0.5*(1.0+sgn*(1.0-Math.exp(-x2)*q1/q2));
        }
        else {
            q0 = 1.0/x2;
            q1 = 6.58749161529837803e-4
                    +q0*(0.0160837851487422766
                    +q0*(0.125781726111229246
                    +q0*(0.360344899949804439
                    +q0*(0.305326634961232344
                    +q0*0.0163153871373020978))));
            q2 = 2.33520497626869185e-3
                    +q0*(0.0605183413124413191
                    +q0*(0.527905102951428412
                    +q0*(1.87295284992346047
                    +q0*(2.56852019228982242+q0))));
            return 0.5*(1.0+sgn*(1.0-Math.exp(-x2)/x*(0.56418958354775628-
                    q0*q1/q2)));
        }
    }
}
